{% extends 'main/base.html' %}

{% block css %}
{% load static %}
<link rel="stylesheet" href="{% static 'main/css/base.css' %}">
{% endblock %}

{% block title %}
Profile
{% endblock %}

{% block content %}
<main>
      <div class="profile-container">
            <!-- Блок профиля -->
          {% if author.username == user.username %}
            <div class="profile-header">
                <a href="{% url 'users:profile_edit' user.username %}" class="profile-link">
                {% if user.avatar %}
                <img src="{{ author.avatar.url }}" alt="Аватар" class="profile-avatar"></a>
                {% else %}
                <img src="{{ default_image }}" alt="Аватар" class="profile-avatar"></a>
                {% endif %}
                <div class="profile-info">
                    <h2>{{ author.first_name }} {{ author.last_name }}</h2>
                    {% if author.location %}
                    <p class="age">Возраст: {{ author.age }}<br>Город: {{ author.location }}<br>Рейтинг: {{ author.rating }}</p>
                    {% else %}
                    <p class="age">Возраст: {{ author.age }}<br>Рейтинг: {{ author.rating }}</p>
                    {% endif %}
                    {% if author.description %}
                    <p class="description">{{ author.description }}</p>
                    {% else %}
                    {% endif %}
                </div>
            </div>
          {% else %}
          <div class="profile-header">
                <img src="{{ author.avatar.url }}" alt="Аватар" class="profile-avatar">
                <div class="profile-info">
                    <h2>{{ author.first_name }} {{ author.last_name }}</h2>
                    <p class="age">Возраст: {{ author.age }} {% if author.location %} <br>Расположение: {{ author.location }} {% endif %} <br> Рейтинг: {{ author.rating }}</p>
                    <p class="description">{{ author.description }}</p>
                </div>
            </div>
          {% endif %}
            <div class="user-skills">
                <h3>Навыки</h3>
                <ul>
                     {% for skill in author.skills.all %}
                     <li>{{ skill.skill }}: {{ skill.level }}
                         <form action="{% url 'delete_skill' skill.id %}" method="post" style="display:inline;">
                        {% csrf_token %}
                        {% if author.username == user.username %}
                        <button type="submit">удалить</button>
                        {% endif %}
                         </form></li>
                     {% empty %}
                         <li>Нет навыков</li>
                     {% endfor %}
                    {% if author.username == user.username %}
                    <a href="{% url 'add_skill_profile' %}">
                        <button type="button">Добавить навык</button>
                    </a>
                    {% endif %}
                 </ul>
            </div>

            <!-- Блок отзывов-->
            <div class="profile-posts">
                <h3>Отзывы о пользователе</h3>
                {% for review in reviews %}
                <div class="post">
                    <div class="user-info">
                        <img src="{{ review.author.avatar.url }}" alt="Аватар">
                        <p class="username">{{ review.author.username }}</p>
                    </div>
                    <div class="post-content">
                        <p>{{ review.comment }}</p>
                        <p>Оценка {{ review.rating }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </main>
{% endblock %}